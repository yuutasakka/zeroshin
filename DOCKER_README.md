# Zeroç¥ Docker ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Zeroç¥ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Dockerã‚’ä½¿ç”¨ã—ã¦èµ·å‹•ãƒ»é‹ç”¨ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ å¿…è¦ãªç’°å¢ƒ

- **Docker**: 20.10.0ä»¥ä¸Š
- **Docker Compose**: 2.0.0ä»¥ä¸Šï¼ˆã¾ãŸã¯`docker compose`ã‚³ãƒãƒ³ãƒ‰ï¼‰
- **Git**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ç”¨
- **OS**: Linuxã€macOSã€Windowsï¼ˆWSL2æ¨å¥¨ï¼‰

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/SakkaYuta/zeroshin.git
cd zeroshin
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```bash
# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
cp .env.example .env

# ç’°å¢ƒå¤‰æ•°ã‚’ç·¨é›†ï¼ˆé‡è¦: å®Ÿéš›ã®å€¤ã«å¤‰æ›´ã—ã¦ãã ã•ã„ï¼‰
nano .env
```

### 3. é–‹ç™ºç’°å¢ƒã®èµ·å‹•

```bash
# ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
./docker-scripts.sh dev

# ã¾ãŸã¯ç›´æ¥Docker Composeã‚’ä½¿ç”¨
docker-compose -f docker-compose.dev.yml up -d
```

### 4. ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: http://localhost:5173
- **API**: http://localhost:3000
- **pgAdmin**: http://localhost:8080
- **Mailhog**: http://localhost:8025

## ğŸ› ï¸ ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½¿ç”¨

Zeroç¥å°‚ç”¨ã®ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `docker-scripts.sh` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹ç™ºç’°å¢ƒã®èµ·å‹•
./docker-scripts.sh dev

# æœ¬ç•ªç’°å¢ƒã®ãƒ‡ãƒ—ãƒ­ã‚¤
./docker-scripts.sh deploy prod

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
./docker-scripts.sh status

# ãƒ­ã‚°è¡¨ç¤º
./docker-scripts.sh logs

# åœæ­¢
./docker-scripts.sh stop

# å®Œå…¨å‰Šé™¤ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚‚å‰Šé™¤ï¼‰
./docker-scripts.sh clean

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³
./docker-scripts.sh security

# ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
./docker-scripts.sh help
```

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### é–‹ç™ºç’°å¢ƒ (`docker-compose.dev.yml`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚  â”‚   API Server    â”‚  â”‚   PostgreSQL    â”‚
â”‚   (Vite)        â”‚  â”‚   (Node.js)     â”‚  â”‚   (Database)    â”‚
â”‚   Port: 5173    â”‚  â”‚   Port: 3000    â”‚  â”‚   Port: 5432    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Redis       â”‚  â”‚    pgAdmin      â”‚  â”‚    Mailhog      â”‚
â”‚   (Cache)       â”‚  â”‚   (DB Admin)    â”‚  â”‚  (Mail Test)    â”‚
â”‚   Port: 6379    â”‚  â”‚   Port: 8080    â”‚  â”‚   Port: 8025    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœ¬ç•ªç’°å¢ƒ (`docker-compose.prod.yml`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Nginx       â”‚  â”‚   API Server    â”‚  â”‚     Redis       â”‚
â”‚  (Web Server)   â”‚  â”‚   (Node.js)     â”‚  â”‚   (Cache)       â”‚
â”‚   Port: 80/443  â”‚  â”‚   Port: 3000    â”‚  â”‚   Port: 6379    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Prometheus    â”‚  â”‚    Grafana      â”‚  â”‚     Trivy       â”‚
â”‚  (Monitoring)   â”‚  â”‚  (Dashboard)    â”‚  â”‚  (Security)     â”‚
â”‚   Port: 9090    â”‚  â”‚   Port: 3001    â”‚  â”‚   Port: 4954    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš™ï¸ è¨­å®šè©³ç´°

### å¿…é ˆç’°å¢ƒå¤‰æ•°

ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã¯å¿…ãšè¨­å®šã—ã¦ãã ã•ã„ï¼š

```bash
# Supabaseè¨­å®š
VITE_SUPABASE_URL=your-supabase-url
VITE_SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# LINEèªè¨¼è¨­å®š
VITE_LINE_CHANNEL_ID=your-line-channel-id
LINE_CHANNEL_SECRET=your-line-channel-secret

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç’°å¢ƒå¤‰æ•°

```bash
# LINE Loginè¨­å®šï¼ˆLINEèªè¨¼ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
LINE_CHANNEL_ID=your-line-channel-id
LINE_CHANNEL_SECRET=your-line-channel-secret
LINE_REDIRECT_URI=https://your-domain.com/api/line-callback

# ç›£è¦–è¨­å®š
GRAFANA_USER=admin
GRAFANA_PASSWORD=secure-password

# Redisè¨­å®šï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
REDIS_PASSWORD=secure-redis-password
```

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. ãƒãƒ¼ãƒˆãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹

```bash
# ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’ç¢ºèª
lsof -i :5173
lsof -i :3000

# ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
kill -9 <PID>
```

#### 2. ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

```bash
# Dockerã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
docker system prune -a

# ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
./docker-scripts.sh clean
./docker-scripts.sh dev
```

#### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# PostgreSQLã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç¢ºèª
docker-compose -f docker-compose.dev.yml logs postgres

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
docker-compose -f docker-compose.dev.yml down -v
docker-compose -f docker-compose.dev.yml up -d postgres
```

#### 4. ç’°å¢ƒå¤‰æ•°ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
cat .env

# ã‚³ãƒ³ãƒ†ãƒŠå†…ã®ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
docker-compose -f docker-compose.dev.yml exec zeroshin-dev env
```

## ğŸ“Š ç›£è¦–ã¨ãƒ­ã‚°

### ãƒ­ã‚°ã®ç¢ºèª

```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
./docker-scripts.sh logs

# ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°
docker-compose -f docker-compose.dev.yml logs -f zeroshin-dev
```

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰

- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3001

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

```bash
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã®å®Ÿè¡Œ
./docker-scripts.sh security
```

## ğŸš¢ æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### SSLè¨¼æ˜æ›¸ã®è¨­å®š

1. SSLè¨¼æ˜æ›¸ã‚’æº–å‚™ï¼š
```bash
mkdir -p ssl
# è¨¼æ˜æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’sslãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
cp your-cert.crt ssl/zeroshin.crt
cp your-private.key ssl/zeroshin.key
```

2. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šï¼š
```bash
SSL_CERT_PATH=/etc/ssl/certs/zeroshin.crt
SSL_KEY_PATH=/etc/ssl/private/zeroshin.key
```

### æœ¬ç•ªç’°å¢ƒã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# æœ¬ç•ªç’°å¢ƒç”¨ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env.production
nano .env.production

# æœ¬ç•ªç’°å¢ƒã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
./docker-scripts.sh deploy prod
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†**
   - `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„
   - å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨
   - å®šæœŸçš„ã«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’æ›´æ–°

2. **Dockerã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
   - érootãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œ
   - æœ€å°æ¨©é™ã®åŸå‰‡
   - å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

3. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
   - ä¸è¦ãªãƒãƒ¼ãƒˆã‚’å…¬é–‹ã—ãªã„
   - ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®è¨­å®š
   - SSL/TLSè¨¼æ˜æ›¸ã®ä½¿ç”¨

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆï¼š

1. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³](#ğŸ”§-ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)ã‚’ç¢ºèª
2. ãƒ­ã‚°ã‚’ç¢ºèªï¼š`./docker-scripts.sh logs`
3. GitHubã®Issuesã§å ±å‘Š
4. é–‹ç™ºãƒãƒ¼ãƒ ã«é€£çµ¡

## ğŸ“š è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹

- [Dockerå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.docker.com/)
- [Docker Compose ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://docs.docker.com/compose/)
- [Zeroç¥ é–‹ç™ºãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](./README.md)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰](./SECURITY.md)